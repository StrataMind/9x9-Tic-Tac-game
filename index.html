<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DXXPY00V0D"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DXXPY00V0D');
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9x9 Tic-Tac Game</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container"></div>
    <div id="title-container">
      <h1>9x9 Tic-Tac Game</h1>
    </div>

    <div id="mode-selection-screen">
      <div id="game-setup">
        <fieldset>
          <legend>Select Game Mode:</legend>
          <label
            ><input type="radio" name="gameMode" value="pvp" checked /> Player
            vs Player</label
          >
          <label
            ><input type="radio" name="gameMode" value="pvc" /> Player vs
            Computer</label
          >
        </fieldset>
        <fieldset id="ai-difficulty-fieldset" class="hidden">
          <legend>AI Difficulty:</legend>
          <label
            ><input type="radio" name="aiDifficulty" value="easy" checked />
            Easy</label
          >
          <label
            ><input type="radio" name="aiDifficulty" value="medium" />
            Medium</label
          >
          <label
            ><input type="radio" name="aiDifficulty" value="hard" /> Hard</label
          >
        </fieldset>
        <fieldset id="timer-settings">
          <legend>Timer Settings:</legend>
          <label
            ><input type="checkbox" id="enable-timer" checked /> Enable Move
            Timer</label
          >
          <div id="timer-duration-container">
            <label for="timer-duration">Time per move (seconds):</label>
            <input
              type="range"
              id="timer-duration"
              min="10"
              max="60"
              value="30"
            />
            <span id="timer-display">30s</span>
          </div>
        </fieldset>
      </div>
      <button id="start-game-button">Start Game</button>
    </div>

    <div id="game-screen" class="hidden">
      <div id="top-controls">
        <button id="rulebook-button">Game Rules</button>
        <button id="stats-button">Statistics</button>
        <button id="undo-button" disabled>Undo</button>
        <button id="redo-button" disabled>Redo</button>
        <button id="restart-button">Restart Game</button>
      </div>
      <div class="board" id="board">
        <!-- Mini-boards will be generated by JavaScript -->
      </div>
      <div id="timer-container" class="hidden">
        <div id="timer-display-game">
          <span id="timer-text">Time: </span>
          <span id="timer-value">30</span>
          <div id="timer-bar">
            <div id="timer-progress"></div>
          </div>
        </div>
      </div>
      <div id="game-status">Player X's turn. Play anywhere!</div>
    </div>

    <div id="game-over-overlay" class="overlay-hidden">
      <div id="game-over-message"></div>
      <button id="play-again-button">Play Again</button>
    </div>

    <div id="rulebook-overlay" class="overlay-hidden">
      <div id="rulebook-content">
        <button id="close-rulebook-button">&times;</button>
        <h2>9x9 Tic-Tac Game Rules</h2>
        <h3>üéØ Objective</h3>
        <p>
          Win the main 3x3 board by winning three mini-games in a row, column,
          or diagonal.
        </p>

        <h3>üß© Board Structure</h3>
        <ul>
          <li>The game has a main 3x3 grid (<strong>main board</strong>).</li>
          <li>
            Each cell in the main board is a 3x3 Tic-Tac-Toe grid (a
            <strong>mini-board</strong>).
          </li>
        </ul>

        <h3>üïπÔ∏è How to Play</h3>
        <ol>
          <li>
            <strong>Initial Move:</strong> Player X starts and can play in any
            cell of any mini-board.
          </li>
          <li>
            <strong>Move Restriction:</strong>
            <ul>
              <li>
                After the first move, the mini-board for the next player is
                determined by the
                <strong>position of the mini-board</strong> just played in.
              </li>
              <li>
                If the last move was in mini-board at
                <code>(row=r, col=c)</code>, the next player must play in a
                mini-board in row <code>r</code> OR column <code>c</code>.
              </li>
              <li>
                <em>Example:</em> Play in top-center (t2) means next play is in
                t1, t2, t3, m2, or b2.
              </li>
              <li>
                <em>Center Exception:</em> Playing in the center mini-board (m2)
                allows the next player to play in any available mini-board.
              </li>
            </ul>
          </li>
          <li>
            <strong>Mini-Board Win:</strong> Get three of your symbols (X or O)
            in a line within a mini-board. A line will be drawn. This win is
            permanent for that mini-board.
          </li>
          <li>
            <strong>Playable Won Boards:</strong> If a won mini-board isn't
            full, players can still be sent there and play in its empty cells.
          </li>
          <li>
            <strong>Fallback Rule:</strong> If all normally targeted mini-boards
            are full, play follows this priority for available (not full)
            mini-boards: Top Row &gt; Middle Row &gt; Bottom Row.
          </li>
          <li>
            <strong>Game Victory:</strong> Win 3 mini-boards in a line
            (horizontal, vertical, or diagonal) on the main board.
          </li>
          <li>
            <strong>Draw:</strong> If all mini-boards are filled and no one has
            won the main board, it's a draw.
          </li>
        </ol>
      </div>
    </div>

    <div id="stats-overlay" class="overlay-hidden">
      <div id="stats-content">
        <button id="close-stats-button">&times;</button>
        <h2>Game Statistics</h2>
        <div id="stats-grid">
          <div class="stat-item">
            <div class="stat-label">Games Played</div>
            <div class="stat-value" id="games-played">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Player X Wins</div>
            <div class="stat-value" id="x-wins">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Player O Wins</div>
            <div class="stat-value" id="o-wins">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Draws</div>
            <div class="stat-value" id="draws">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Win Rate (X)</div>
            <div class="stat-value" id="x-win-rate">0%</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Average Game Time</div>
            <div class="stat-value" id="avg-time">0s</div>
          </div>
        </div>
        <button id="reset-stats-button">Reset Statistics</button>
      </div>
    </div>

    <!-- Audio elements for sound effects -->
    <audio id="move-sound" preload="auto">
      <source
        src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsF"
        type="audio/wav"
      />
    </audio>
    <audio id="win-sound" preload="auto">
      <source
        src="data:audio/wav;base64,UklGRvQDAABXQVZFZm10IBAAAAABAAEAESsAADFWAAABAAgAZGF0YdADAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsFJHfH8N2QQAoUXrTp66hVFApGn+DyvWYdCy2N0/LNeSsF"
        type="audio/wav"
      />
    </audio>
    <script src="script.js"></script>
  </body>
</html>
